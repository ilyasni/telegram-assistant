# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–Ω–∞–ª–æ–≤ —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º

**–î–∞—Ç–∞**: 2025-01-22  
**Context7**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤ —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º –º–µ–∂–¥—É last_post_date –∏ –Ω–æ–≤—ã–º–∏ –ø–æ—Å—Ç–∞–º–∏

---

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º

### –¢–æ–ø-10 –∫–∞–Ω–∞–ª–æ–≤ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º:

1. **new_yorko_times** - 9.7 –¥–Ω–µ–π (232 —á–∞—Å–∞)
   - `last_post_date`: 2025-11-07 14:59:55
   - `last_parsed_at`: 2025-11-16 18:23:38
   - –°—Ç–∞—Ç—É—Å: –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

2. **pdigest** - 7.0 –¥–Ω–µ–π (168 —á–∞—Å–æ–≤)
   - `last_post_date`: 2025-11-10 08:04:58
   - `last_parsed_at`: 2025-11-16 21:24:41
   - –°—Ç–∞—Ç—É—Å: –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

3. **dsoloveev** - 6.9 –¥–Ω–µ–π (166 —á–∞—Å–æ–≤)
   - `last_post_date`: 2025-11-10 09:57:06
   - `last_parsed_at`: 2025-11-16 18:04:25
   - –°—Ç–∞—Ç—É—Å: –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

4. **desprod** - 5.8 –¥–Ω–µ–π (140 —á–∞—Å–æ–≤)
5. **b_goncharenko** - 5.5 –¥–Ω–µ–π (132 —á–∞—Å–∞)
6. **fffworks** - 5.1 –¥–Ω–µ–π (122 —á–∞—Å–∞)
7. **ruspm** - 4.9 –¥–Ω–µ–π (117 —á–∞—Å–æ–≤)
8. **postpostresearch** - 4.1 –¥–Ω–µ–π (98 —á–∞—Å–æ–≤)
9. **AlfaBank** - 3.8 –¥–Ω–µ–π (91 —á–∞—Å)
10. **aiwizards** - 3.6 –¥–Ω–µ–π (86 —á–∞—Å–æ–≤)

---

## –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (C7-ID: incremental-old-date-fix-001, 002):

1. **–ù–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ historical —Ä–µ–∂–∏–º** –ø—Ä–∏ —Å—Ç–∞—Ä—ã—Ö –¥–∞—Ç–∞—Ö
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º `last_post_date` –∫–∞–∫ –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É
   - –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏–º –ø–æ—Å—Ç—ã –º–µ–∂–¥—É `last_post_date` –∏ `now`

2. **–ù–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º since_date** –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞—Ç
   - –£–±—Ä–∞–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ `min_since_date` –¥–ª—è incremental —Ä–µ–∂–∏–º–∞
   - –ü–∞—Ä—Å–∏–º –≤—Å–µ –ø–æ—Å—Ç—ã –ø–æ—Å–ª–µ `last_post_date`, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –±–æ–ª—å—à–µ 24 —á–∞—Å–æ–≤

### –ö–æ–¥ –ª–æ–≥–∏–∫–∏:

```python
# Context7: [C7-ID: incremental-old-date-fix-001] –ö–†–ò–¢–ò–ß–ù–û - –µ—Å–ª–∏ –±–∞–∑–æ–≤–∞—è –¥–∞—Ç–∞ —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä–∞—è,
# –ù–ï –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ historical —Ä–µ–∂–∏–º, –∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º last_post_date –∫–∞–∫ –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É
age_hours = (now - base_utc).total_seconds() / 3600
if age_hours > self.config.lpa_max_age_hours:
    logger.warning(
        "Base date too old, but using it as lower bound to avoid missing posts",
        channel_id=channel_id,
        age_hours=age_hours,
        base_date=base_utc.isoformat()
    )
    # –ù–ï –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ historical - –∏—Å–ø–æ–ª—å–∑—É–µ–º last_post_date –∫–∞–∫ –µ—Å—Ç—å

# Context7: [C7-ID: incremental-old-date-fix-002] –ö–†–ò–¢–ò–ß–ù–û - –ù–ï –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º since_date –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞—Ç
# –ï—Å–ª–∏ last_post_date —Å—Ç–∞—Ä—ã–π, –º—ã –¥–æ–ª–∂–Ω—ã –ø–∞—Ä—Å–∏—Ç—å –≤—Å–µ –ø–æ—Å—Ç—ã –ø–æ—Å–ª–µ –Ω–µ–≥–æ, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –±–æ–ª—å—à–µ 24 —á–∞—Å–æ–≤
# –£–±–∏—Ä–∞–µ–º —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è incremental —Ä–µ–∂–∏–º–∞, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ç—É –ø–∞—Ä—Å–∏–Ω–≥–∞
```

---

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ö–∞–Ω–∞–ª —Å —Ä–∞–∑—Ä—ã–≤–æ–º 9+ –¥–Ω–µ–π

**–ö–∞–Ω–∞–ª**: `new_yorko_times`
- `last_post_date`: 2025-11-07 14:59:55
- –†–∞–∑—Ä—ã–≤: 9.7 –¥–Ω–µ–π
- –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
  - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `last_post_date` –∫–∞–∫ `base_utc`
  - ‚úÖ `since_date` = `last_post_date - overlap` (–Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è 24 —á–∞—Å–∞–º–∏)
  - ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤ –ø–æ—Å–ª–µ `last_post_date`
  - ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "Base date too old, but using it as lower bound"

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ö–∞–Ω–∞–ª —Å —Ä–∞–∑—Ä—ã–≤–æ–º 5-7 –¥–Ω–µ–π

**–ö–∞–Ω–∞–ª**: `pdigest`, `dsoloveev`
- –†–∞–∑—Ä—ã–≤: 5-7 –¥–Ω–µ–π
- –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
  - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `last_post_date` –∫–∞–∫ `base_utc`
  - ‚úÖ `since_date` –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è
  - ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤ –ø–æ—Å–ª–µ `last_post_date`

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–∞–Ω–∞–ª —Å –Ω–æ–≤—ã–º–∏ –ø–æ—Å—Ç–∞–º–∏ –ø–æ—Å–ª–µ –±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑—Ä—ã–≤–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞**: –ï—Å—Ç—å –ª–∏ –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã –ø–æ—Å–ª–µ `last_post_date`?
- –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã ‚Üí –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω—ã
- –ï—Å–ª–∏ –Ω–µ—Ç –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ ‚Üí –ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º
docker compose exec supabase-db psql -U postgres -d postgres -c "
SELECT c.username, 
       MAX(p.posted_at) as last_post_date,
       NOW() - MAX(p.posted_at) as gap,
       EXTRACT(EPOCH FROM (NOW() - MAX(p.posted_at))) / 86400 as days_ago
FROM channels c
LEFT JOIN posts p ON p.channel_id = c.id
WHERE c.is_active = true
GROUP BY c.id, c.username
HAVING MAX(p.posted_at) IS NOT NULL
ORDER BY days_ago DESC
LIMIT 10;
"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤ —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º
docker compose logs telethon-ingest --since 2h | grep -E "(new_yorko_times|pdigest|dsoloveev)" | grep -E "(since_date|age_hours|Base date too old|messages_processed)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤ —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º
docker compose exec supabase-db psql -U postgres -d postgres -c "
SELECT c.username, 
       COUNT(p.id) as posts_count,
       COUNT(p.id) FILTER (WHERE p.created_at > NOW() - INTERVAL '24 hours') as last_24h
FROM channels c
JOIN posts p ON p.channel_id = c.id
WHERE c.username IN ('new_yorko_times', 'pdigest', 'dsoloveev')
GROUP BY c.id, c.username;
"
```

---

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

1. ‚úÖ **–õ–æ–≥–∏–∫–∞ –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø–æ—Å—Ç—ã** –ø—Ä–∏ –±–æ–ª—å—à–æ–º —Ä–∞–∑—Ä—ã–≤–µ
2. ‚úÖ **since_date –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è** 24 —á–∞—Å–∞–º–∏ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞—Ç
3. ‚úÖ **–õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ** –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ > `lpa_max_age_hours`
4. ‚úÖ **–ü–∞—Ä—Å–∏–Ω–≥ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –ø–æ—Å—Ç—ã** –ø–æ—Å–ª–µ `last_post_date`

---

## –°—Ç–∞—Ç—É—Å

üîÑ **–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏–∫—É –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤ —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º.

