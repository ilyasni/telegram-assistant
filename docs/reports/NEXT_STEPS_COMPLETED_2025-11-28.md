# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤ - –û—Ç—á–µ—Ç

**–î–∞—Ç–∞**: 2025-11-28  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ß–∞—Å—Ç–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

---

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —à–∞–≥–∏

### 1. ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ tg_channel_id –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤ –±–µ–∑ –Ω–µ–≥–æ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ó–∞–ø—É—â–µ–Ω —Å–∫—Ä–∏–ø—Ç `populate_channel_ids.py`
- –ó–∞–ø–æ–ª–Ω–µ–Ω–æ 2 –∫–∞–Ω–∞–ª–∞:
  - `vpoiskahpiva` (fb5f8d45-33d4-49e2-bce8-c1ef5e0c1593) ‚Üí `tg_channel_id: -1600269342`
  - `dvapiva` (59b172a0-26f3-4a40-a9ff-d219dfa1c026) ‚Üí `tg_channel_id: -1373683934`
- –¢–µ–ø–µ—Ä—å –Ω–µ—Ç –∫–∞–Ω–∞–ª–æ–≤ –±–µ–∑ `tg_channel_id` (0 rows)

### 2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–æ—Å—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è!
- –í—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤: 6522 (–±—ã–ª–æ 6143) - **+379 –ø–æ—Å—Ç–æ–≤**
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Å—Ç: 2025-11-28 09:34:28 (–±—ã–ª–æ 07:09:01) - **+2 —á–∞—Å–∞ 25 –º–∏–Ω—É—Ç**
- –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–∞: 58 –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤

### 3. ‚ö†Ô∏è –ö–∞–Ω–∞–ª—ã —Å `last_parsed_at = NULL` –≤—Å–µ –µ—â–µ –Ω–µ –ø–∞—Ä—Å—è—Ç—Å—è

**–°—Ç–∞—Ç—É—Å:**
- 8 –∫–∞–Ω–∞–ª–æ–≤ —Å `last_parsed_at = NULL` –≤—Å–µ –µ—â–µ –Ω–µ –ø–∞—Ä—Å—è—Ç—Å—è
- –í—Å–µ –∫–∞–Ω–∞–ª—ã –∏–º–µ—é—Ç `tg_channel_id` –∏ `username`
- –í—Å–µ –∫–∞–Ω–∞–ª—ã –∞–∫—Ç–∏–≤–Ω—ã (`is_active = true`)
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–∞–Ω–∞–ª—ã –Ω–µ –∏–º–µ—é—Ç –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (105957884)

**–ö–∞–Ω–∞–ª—ã:**
1. `aigentto` (9889b020-f10d-49a1-9bd2-2b563768bc38) - –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏
2. `PragmaticMarketingShkipin` (cb52274f-08c0-4255-b8a2-76e33f480074) - –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏
3. `Test E2E Channel` (0f63da91-9abb-4d13-a147-63d57ce66108) - –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏, –æ—à–∏–±–∫–∞ "No user has \"test_e2e_channel\" as username"
4. `vpoiskahpiva` (fb5f8d45-33d4-49e2-bce8-c1ef5e0c1593) - —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–ø–æ–ª–Ω–µ–Ω `tg_channel_id`
5. `dvapiva` (59b172a0-26f3-4a40-a9ff-d219dfa1c026) - —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–ø–æ–ª–Ω–µ–Ω `tg_channel_id`
6. `beer_for_all` (827b661b-eb44-417e-beec-12c8fd51a454) - –µ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∫–∞
7. `beer_by` (d53aaa61-e88d-4d07-badb-12758b990603) - –µ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∫–∞
8. `prostopropivo` (5027bfe9-aa9f-45c7-96f8-53acf015384a) - –µ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∫–∞

---

## –ü—Ä–æ–±–ª–µ–º—ã

### 1. –ö–∞–Ω–∞–ª—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ø–∞—Ä—Å–∏–Ω–≥

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ö–∞–Ω–∞–ª—ã –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ –ª–æ–≥–∞—Ö "Channel parsing status"
- –í–æ–∑–º–æ–∂–Ω–æ, –æ–Ω–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –≤—ã–±–æ—Ä–∫—É scheduler'–∞ –∏–ª–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ä–∞–Ω–Ω–µ–º —ç—Ç–∞–ø–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—á–µ–º—É –∫–∞–Ω–∞–ª—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –≤—ã–±–æ—Ä–∫—É `_get_active_channels()`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ scheduler'–∞ –¥–ª—è —ç—Ç–∏—Ö –∫–∞–Ω–∞–ª–æ–≤
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–∞–Ω–∞–ª—ã —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (NULLS FIRST)

### 2. –ö–∞–Ω–∞–ª `test_e2e_channel` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Telegram

**–ü—Ä–∏—á–∏–Ω–∞:**
- –û—à–∏–±–∫–∞: "No user has \"test_e2e_channel\" as username"
- –ö–∞–Ω–∞–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Telegram –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–Ω–∞–ª –∫–∞–∫ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å
- –ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å `username` –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—á–µ–º—É –∫–∞–Ω–∞–ª—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ø–∞—Ä—Å–∏–Ω–≥

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ scheduler'–∞ –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤ —Å NULL last_parsed_at
docker logs telegram-assistant-telethon-ingest-1 --since 30m | grep -E "Active channels retrieved|new_channels"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ–ø–∞–¥–∞—é—Ç –ª–∏ –∫–∞–Ω–∞–ª—ã –≤ –≤—ã–±–æ—Ä–∫—É
docker exec telegram-assistant-supabase-db-1 psql -U postgres -d postgres -c "SELECT id, title, username, last_parsed_at FROM channels WHERE is_active = true ORDER BY last_parsed_at NULLS FIRST LIMIT 10;"
```

### 2. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–Ω–∞–ª `test_e2e_channel`

```bash
# –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–Ω–∞–ª –∫–∞–∫ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π
docker exec telegram-assistant-supabase-db-1 psql -U postgres -d postgres -c "UPDATE channels SET is_active = false WHERE id = '0f63da91-9abb-4d13-a147-63d57ce66108';"
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞—Ä—Å–∏–Ω–≥–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤ —Å NULL last_parsed_at
docker logs telegram-assistant-telethon-ingest-1 --since 10m | grep -E "Channel parsing status.*is_new_channel.*true"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã
docker exec telegram-assistant-supabase-db-1 psql -U postgres -d postgres -c "SELECT COUNT(*), MAX(posted_at) FROM posts WHERE posted_at > NOW() - INTERVAL '1 hour';"
```

---

## –ò—Ç–æ–≥–∏

### ‚úÖ –£—Å–ø–µ—à–Ω–æ:
1. –ó–∞–ø–æ–ª–Ω–µ–Ω—ã `tg_channel_id` –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤ –±–µ–∑ –Ω–µ–≥–æ (2 –∫–∞–Ω–∞–ª–∞)
2. –ü–æ—Å—Ç—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è (379 –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —á–∞—Å—ã)
3. –ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∫–∞–Ω–∞–ª–æ–≤

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
1. 8 –∫–∞–Ω–∞–ª–æ–≤ —Å `last_parsed_at = NULL` –≤—Å–µ –µ—â–µ –Ω–µ –ø–∞—Ä—Å—è—Ç—Å—è
2. –ö–∞–Ω–∞–ª `test_e2e_channel` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Telegram
3. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–∞–Ω–∞–ª—ã –Ω–µ –∏–º–µ—é—Ç –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- –í—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤: 6522 (+379)
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Å—Ç: 2025-11-28 09:34:28
- –ù–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ –∑–∞ 2 —á–∞—Å–∞: 58
- –ö–∞–Ω–∞–ª–æ–≤ –±–µ–∑ `tg_channel_id`: 0
- –ö–∞–Ω–∞–ª–æ–≤ —Å `last_parsed_at = NULL`: 8

